services:
  suricata:
    image: jasonish/suricata:{{ suricata_version }}
    container_name: suricata
    network_mode: host
    cap_add:
      - NET_ADMIN
      - NET_RAW
      - SYS_NICE
    volumes:
      - {{ base_directory }}/suricata:/opt/suricata
      - {{ suricata_log_path }}:/var/log/suricata
      - {{ base_directory }}/suricata/suricata.yaml:/etc/suricata/suricata.yaml:ro
    command: ["/opt/suricata/suricata-entrypoint.sh"]
    restart: unless-stopped
