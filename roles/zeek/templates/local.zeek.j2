##! Local site policy for Zeek Network Security Monitor
##! Customize this file to match your network environment

# Load standard Zeek scripts
@load base/frameworks/software
@load base/frameworks/intel
@load base/protocols/conn
@load base/protocols/dns
@load base/protocols/http
@load base/protocols/ssl
@load base/protocols/smtp
@load base/protocols/ssh
@load base/protocols/ftp

# Enable file analysis
@load frameworks/files/hash-all-files
@load frameworks/files/extract-all-files

# Load JA4+ fingerprinting
@load ja4plus

# Network configuration
redef Site::local_nets += {
    10.0.0.0/8,
    172.16.0.0/12,
    192.168.0.0/16,
};

# Logging configuration
redef LogAscii::use_json = T;

# Configure extraction limits
redef FileExtract::extraction_limit = 10MB;

# JA4+ configuration
# JA4+ will automatically log fingerprints in:
# - ja4.log (JA4 TLS client fingerprints)
# - ja4s.log (JA4S TLS server fingerprints) 
# - ja4h.log (JA4H HTTP client fingerprints)
# - ja4ssh.log (JA4SSH SSH fingerprints)
